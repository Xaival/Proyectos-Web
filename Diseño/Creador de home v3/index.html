<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 88.5 86.18'%3E%3Cpath d='M87.7,41.11L46.2.75c-.54-.53-1.25-.78-1.95-.75-.7-.03-1.41.23-1.95.75L.81,41.11c-1.06,1.03-1.09,2.73-.05,3.79h0c1.03,1.06,2.73,1.09,3.79.05L44.25,6.34l39.7,38.61c1.06,1.03,2.75,1.01,3.79-.05s1.01-2.75-.05-3.79h.01Z' style='fill: %23fff;'/%3E%3Cpath d='M42.45,17.82l-31.64,30.75c-.5.49-.79,1.15-.79,1.85v33.18c0,1.42,1.16,2.59,2.59,2.59h18.94c1.42,0,2.59-1.16,2.59-2.59v-23.99c0-1.42,1.16-2.59,2.59-2.59h15.07c1.42,0,2.59,1.16,2.59,2.59v23.99c0,1.42,1.16,2.59,2.59,2.59h18.94c1.42,0,2.59-1.16,2.59-2.59v-33.18c0-.7-.28-1.37-.79-1.85l-31.64-30.75c-1.01-.97-2.6-.97-3.61,0Z' style='fill: %23fff;'/%3E%3C/svg%3E">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  transition: all 0.2s ease;
}
body {
	background: linear-gradient(to top, #29007f, #00001e);
	background-size: cover;
	background-attachment: fixed;
	min-height: 100vh;
	padding: 50px 0px;
	color: white;
	font-family: Arial;
}
.view, .edit {
	width: 100%;
	flex-direction: column;
	align-items: center;
	gap: 40px;
}
body .view {display: flex;}
body .edit {display: none;}
body.editor .view{display: none;}
body.editor .edit{display: flex;}

@media (max-width: 800px) {
  body.editor .view {display: flex;}
  body.editor .edit {display: none;}
  body.editor footer {display: none;}
}


/* ------------------------------------------------------*/
/* Vista */
/* ------------------------------------------------------*/


/* Buscador */
/* ------------------------------------------------------*/
.buscador {
	background-color: #5a0fff80;
	width: 100%;
	max-width: 500px;
	padding: 10px 20px;
	padding-right: 10px;
	border-radius: 15px;
	display: flex;
	justify-content: center;
	align-items: center;
	gap: 10px;
}
.buscador button:hover {transform: scale(1.1);}
.buscador button:active {transform: scale(0.9);}
.buscador input {
	background-color: transparent;
	width: 100%;
	height: 1.5em;
	border: 0;
	outline: 0;
	flex: auto;
	color: white;
	font-size: 1.25em;
}
.buscador input::placeholder {color: #d7c8ff80;}
.buscador button {
	background: white;
	height: 40px;
	aspect-ratio: 1 / 1;
	border: 0;
	border-radius: 2em;
	cursor: pointer;
	display: flex;
	justify-content: center;
	align-items: center;
	transition: all .25s ease-out;
}
.buscador button svg {width: 2em; height: 2em;}


/* Destacado */
/* ------------------------------------------------------*/
#destacado {
	width: 100%;
	padding: 5px 20px;
	overflow-x: auto;
	overflow-y: hidden;
	cursor: pointer;
	display: flex;
	justify-content: center;
	gap: 20px;
	user-select: none;
	scrollbar-width: none;
}
@media (max-width: 850px) {
  #destacado {justify-content: flex-start;}
}
#destacado a {
	background-color: #7d7dd240;
	width: 100px;
	height: 100px;
  aspect-ratio: 1 / 1;
	padding: 20px;
	border-radius: 20px;
	display: block;
}
#destacado a:hover {transform: scale(1.05);}
#destacado a:active {transform: scale(0.95);}
#destacado a .img {
	background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
	width: 100%;
	height: 100%;
}
#destacado a:hover img {background-color: #adadf540;}


/* Marcadores */
/* ------------------------------------------------------*/
.marcadores {
	background-color: #5a0fff80;
	width: calc(100% - 40px);
	max-width: 1400px;
	padding: 20px;
	border: 1px solid #5b0eff;
	border-radius: 20px;
}
.marcadores h2 {margin-bottom: 15px; text-align: center;}
.marcadores a:hover {transform: scale(1.01);}
.marcadores a:active {transform: scale(0.99);}
.marcadores #grupos {
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	gap: 20px;
}
.marcadores .grupo {
	background-color: #0003;
	min-width: 30%;
	padding: 20px;
	border-radius: 20px;
	flex: 1;
}
@media (max-width: 1200px) {
  .marcadores .grupo {min-width: 45%;}
}
@media (max-width: 800px) {
  .marcadores .grupo {min-width: 100%;}
}
.marcadores .grupo h3 {margin-bottom: 10px; text-align: center;}
.marcadores .marcador {
	width: 100%;
	margin: 5px 0;
	padding: 4px 8px;
	border-radius: 8px;
	display: flex;
	align-items: center;
	gap: .5em;
	color: white;
	text-decoration: none;
}
.marcadores .marcador:hover {background-color: #5a0fff80;}
.marcador .img{width: 2em; height: 2em;}
.marcador .img, .edit #loadIMG .img {
	background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23FFF' viewBox='0 0 512.001 512.001'%3E%3Cpath d='M257.297,0.004c-0.018,0-0.035,0-0.053-0.001C257.162,0.003,257.081,0,257,0c-0.012,0-0.024,0-0.036,0    c-0.032,0-0.065,0.001-0.097,0.001C115.786,0.073,0,114.252,0,255c0,34.416,6.855,67.932,20.376,99.618    c26.177,61.348,75.527,110.772,137.005,137.005c31.682,13.519,65.194,20.375,99.605,20.376c0.009,0,0.018,0.002,0.027,0.002    c0.023,0,0.047-0.002,0.07-0.003C398.634,511.953,512,395.326,512,255C512,114.274,398.242,0.163,257.297,0.004z M207.317,35.443    C181.736,59.695,160.835,88.099,145.096,120H75.515C107.426,77.96,153.837,47.325,207.317,35.443z M56.286,149.8h75.991    c-10.493,28.747-16.697,59.387-18.298,90.2H30.517C32.674,207.672,41.749,176.993,56.286,149.8z M56.851,362    c-14.89-27.74-24.173-58.913-26.342-92h83.368c1.432,31.496,7.682,62.631,18.402,92H56.851z M76.129,392h68.967    c15.709,31.842,36.581,60.236,62.154,84.494C154.137,464.571,108.007,433.983,76.129,392z M143.921,270h98.078v92h-77.373    C152.648,333.142,145.53,302.081,143.921,270z M242.001,467.115C216.497,445.88,195.351,420.38,179.27,392h62.73V467.115z     M242.001,240h-97.979c1.799-31.373,8.876-61.742,20.606-90h77.373V240z M242.001,120h-62.729    c16.08-28.38,37.226-53.88,62.729-75.116V120z M455.945,150c14.41,27.193,23.404,57.672,25.543,90H400.02    c-1.601-30.813-7.805-61.253-18.298-90H455.945z M436.887,120h-67.982c-15.697-31.817-36.546-60.189-62.088-84.433    C359.585,47.541,405.369,78.11,436.887,120z M272.001,44.89c25.503,21.236,46.657,46.73,62.737,75.11h-62.737V44.89z M272,150    h77.392c11.728,28.256,18.789,58.629,20.588,90H272V150z M370.088,269.8c-1.608,32.079-8.719,63.344-20.696,92.2h-77.392v-92.2    H370.088z M272.001,467.11V391.8h62.737C318.658,420.18,297.504,445.873,272.001,467.11z M306.885,476.368    c25.491-24.21,46.326-52.757,62.019-84.568h67.373C404.796,433.63,359.29,464.353,306.885,476.368z M381.723,362    c10.72-29.369,16.97-60.704,18.402-92.2h81.372c-2.15,33.087-11.351,64.46-26.11,92.2H381.723z'/%3E%3C/svg%3E");
	background-position: center;
	background-size: contain;
    background-repeat: no-repeat;
    transition: none;
}



/* Footer */
/* ------------------------------------------------------*/
footer button {
	background: transparent;
	border: 0px;
	cursor: pointer;
	color: #ffffff40;
	font-size: 1.1em;
}
footer button:hover {color: #ffffff;}



/* ------------------------------------------------------*/
/* Vista edicion */
/* ------------------------------------------------------*/
.edit :is(button, input) {
	background-color: #14142380;
	height: 35px;
	padding: 5px 10px;
	border: 0px;
	border-radius: 15px;
	outline: 0px;
	color: white;
}
.edit button {cursor: pointer;}
.edit button:hover {transform: scale(1.1);}
.edit button:active {transform: scale(0.9);}


.edit header {display: flex; gap: 20px;}
.edit header button {
	background-color: #7d7dd240;
	width: 100px;
	height: 100px;
	padding: 20px;
	border-radius: 20px;
}
.edit header button:hover {
	background-color: #adadf540;
	transform: scale(1.05);
}
.edit header button:active {transform: scale(0.95);}
body:not(.php) .edit header button[onclick="updatePHP()"] {display: none}
.edit header svg {
	width: 50px;
	height: 50px;
	margin-bottom: 5px;
}

#destacadoEdit, #marcadoresEdit {
	background-color: #4b19c880;
	width: calc(100% - 40px);
	max-width: 800px;
	padding: 20px;
	border: 1px solid #3f0ea7;
	border-radius: 20px;
}
.edit h2 {text-align: center;}

.edit .grupo {
	background: #1e195080;
	margin-top: 10px;
	padding: 20px;
	border-radius: 20px;
	text-align: center;
	position: relative;
}
.edit .grupo::before {
	content: "";
	width: 100%;
	height: 10px;
	left: 0;
	bottom: 100%;
	position: absolute;
}
.edit .grupo::after {
	content: "";
	width: 100%;
	position: absolute;
	left: 0;
	height: 2px;
	z-index: 1;
	top: -6px;
}
.edit .grupo.moveUP::after {background: #03A9F4;}
.edit .grupo.moveDOWN::after {top: initial; bottom: -6px; background: #03A9F4;}

.edit .gru {
	display: flex;
	justify-content: center;
	align-items: center;
	gap: 10px;
    cursor: pointer;
}
.edit .gru input {
	width: 50%;
	margin: auto 0;
}

.edit .list {
	margin-top: 10px;
	display: flex;
	flex-direction: column;
}
.edit .list .marcador {
	display: flex;
	align-items: center;
	gap: 10px;
    padding: 5px 0;
    position: relative;
    justify-content: space-between;
}
.edit .list .marcador::after {
	content: "";
	width: 100%;
	position: absolute;
	left: 0;
	height: 2px;
	z-index: 1;
	top: -1px;
}
.edit .list .marcador.moveUP::after {background: #03A9F4;}
.edit .list .marcador.moveDOWN::after {top: initial; bottom: -1px; background: #03A9F4;}
.edit .list .marcador .img:hover {
	cursor: pointer;
	background-size: 45%;
	background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 320 512'%3E%3Cpath d='M40 352l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40zm192 0l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40zM40 320c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0zM232 192l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40zM40 160c-22.1 0-40-17.9-40-40L0 72C0 49.9 17.9 32 40 32l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0zM232 32l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40z'/%3E%3C/svg%3E")!important;
}
.edit .list .marcador input {flex: 1;}

/* Botones de añadir y eliminar */
/* ------------------------------------------------------*/
.edit button.DelAdd i {width: 21px; height: 21px;}
.edit button.DelAdd i {content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 125 153' fill='%23e52421'%3E%3Cpath d='M12.5,28v125h100V28H12.5ZM40,140.5h-15V40.5h15v100ZM70,140.5h-15V40.5h15v100ZM100,140.5h-15V40.5h15v100Z'/%3E%3Crect width='125' height='18'/%3E%3C/svg%3E");}
.edit .marcador:last-of-type button.DelAdd i,
.edit .grupo:last-of-type .gru button.DelAdd i {content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 153 153' fill='%23fff'%3E%3Crect x='66.5' width='20' height='153'/%3E%3Crect x='66.5' y='0' width='20' height='153' transform='translate(153 0) rotate(90)'/%3E%3C/svg%3E");}


.edit #loadIMG {
	position: fixed;
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	display: none;
    background-color: #19191940;
    align-items: center;
    justify-content: center;
}
.edit #loadIMG.active {display: flex;}
.edit #loadIMG .back {
	width: 100%;
	height: 100%;
	position: absolute;
	top: 0;
	left: 0;
    backdrop-filter: blur(2px);
}
.edit #loadIMG .windows {
	width: 500px;
    background-color: #4b19c880;
    backdrop-filter: blur(5px);
    padding: 20px;
    border: 1px solid #3f0ea7;
    border-radius: 20px;
    display: flex;
    align-items: center;
    flex-direction: column;
}
.edit #loadIMG .img {
	width: 250px;
	height: 250px;
	aspect-ratio: 1/1;
	margin: 15px 0;
	background-size: 90%;
    background-color: #000000bf;
    backdrop-filter: blur(10px);
    border-radius: 15px;
}
.edit #loadIMG .option {width: 100%; display: flex; gap: 10px}
.edit #loadIMG .option input[type="text"] {flex: 1;}
.edit #loadIMG .option input[type="button"] {width: 75px; cursor: pointer;}
</style>
</head>
<body class="php">
  <div class="view">  
    <label class="buscador" for="searchInput">
      <input type="text" placeholder="Busqueda..." id="searchInput" onkeypress="buscar(event)" oninput="filtrarMarcadores()">
      <button type="button" onclick="searchGoogle()"><svg viewBox="0 0 512 512"><path style="fill:#FBBB00;" d="M113.47,309.408L95.648,375.94l-65.139,1.378C11.042,341.211,0,299.9,0,256  c0-42.451,10.324-82.483,28.624-117.732h0.014l57.992,10.632l25.404,57.644c-5.317,15.501-8.215,32.141-8.215,49.456  C103.821,274.792,107.225,292.797,113.47,309.408z"></path><path style="fill:#518EF8;" d="M507.527,208.176C510.467,223.662,512,239.655,512,256c0,18.328-1.927,36.206-5.598,53.451  c-12.462,58.683-45.025,109.925-90.134,146.187l-0.014-0.014l-73.044-3.727l-10.338-64.535  c29.932-17.554,53.324-45.025,65.646-77.911h-136.89V208.176h138.887L507.527,208.176L507.527,208.176z"></path><path style="fill:#28B446;" d="M416.253,455.624l0.014,0.014C372.396,490.901,316.666,512,256,512  c-97.491,0-182.252-54.491-225.491-134.681l82.961-67.91c21.619,57.698,77.278,98.771,142.53,98.771  c28.047,0,54.323-7.582,76.87-20.818L416.253,455.624z"></path><path style="fill:#F14336;" d="M419.404,58.936l-82.933,67.896c-23.335-14.586-50.919-23.012-80.471-23.012  c-66.729,0-123.429,42.957-143.965,102.724l-83.397-68.276h-0.014C71.23,56.123,157.06,0,256,0  C318.115,0,375.068,22.126,419.404,58.936z"></path></svg></button>
      <button type="button" onclick="searchDuckDuckGo()"><svg viewBox="0 0 256 255"><path d="M128.145,18.841 C188.147,18.841 236.788,67.482 236.788,127.484 C236.788,187.485 188.147,236.126 128.145,236.126 C68.144,236.126 19.503,187.485 19.503,127.484 C19.503,67.482 68.144,18.841 128.145,18.841" fill="#DE5833"></path><path d="M128.143,254.922 C198.526,254.922 255.583,197.865 255.583,127.482 C255.583,57.099 198.526,0.042 128.143,0.042 C57.76,0.042 0.703,57.099 0.703,127.482 C0.703,197.865 57.76,254.922 128.143,254.922 L128.143,254.922 Z M128.143,244.302 C63.625,244.302 11.323,192 11.323,127.482 C11.323,62.964 63.625,10.662 128.143,10.662 C192.661,10.662 244.963,62.964 244.963,127.482 C244.963,192 192.661,244.302 128.143,244.302 L128.143,244.302 Z" fill="#DE5833"></path><g transform="translate(66.000000, 42.000000)"><path d="M9.219,12.13 C9.198,10.303 10.525,9.28 12.288,8.563 C11.481,8.695 10.708,8.897 10.012,9.209 C8.174,10.042 6.8,13.196 6.813,14.689 C15.736,13.787 28.931,14.411 38.58,17.291 C39.292,17.191 40.004,17.091 40.727,17.008 C31.103,12.735 19.661,11.085 9.219,12.13" fill="#D5D7D8"></path><path d="M11.048,1.15 C11.249,1.114 11.453,1.089 11.655,1.055 C9.73,1.294 8.715,1.982 7.27,2.219 C8.839,2.358 14.784,5.133 18.52,6.659 C19.044,6.46 19.516,6.239 19.901,5.978 C17.964,5.692 13.151,1.342 11.048,1.15" fill="#D5D7D8"></path><path d="M20.326,22.756 C19.791,22.962 19.283,23.177 18.843,23.408 C4.298,31.071 -2.127,48.97 1.702,70.418 C5.197,89.936 19.522,156.623 26.081,187.989 C27.996,188.662 29.934,189.287 31.896,189.854 C26.055,161.614 10.112,87.614 6.392,66.831 C2.621,45.688 6.29,30.517 20.326,22.756" fill="#D5D7D8"></path><path d="M79.184,176.618 C78.944,176.778 78.658,176.928 78.353,177.074 C78.127,177.95 77.782,178.614 77.279,178.948 C74.275,180.941 65.79,181.945 61.31,180.941 C60.539,180.77 59.955,180.487 59.499,180.098 C51.85,184.345 40.85,189.999 38.616,188.725 C35.126,186.724 34.62,160.274 35.126,153.783 C35.495,148.883 52.707,156.82 61.08,160.983 C62.931,159.254 67.466,158.097 71.48,157.704 C65.415,142.943 60.942,126.059 63.684,114.086 C59.894,111.445 54.871,105.32 55.917,98.927 C56.723,94.061 69.297,84.855 78.2,84.299 C87.123,83.736 89.904,83.863 97.338,82.083 C97.71,81.994 98.119,81.896 98.547,81.793 C103.123,65.706 92.148,37.719 79.906,25.472 C75.915,21.481 69.779,18.969 62.865,17.643 C60.206,13.994 55.917,10.505 49.845,7.274 C38.57,1.288 24.636,-1.149 11.655,1.055 C11.453,1.089 11.249,1.114 11.048,1.15 C13.151,1.342 17.964,5.692 19.901,5.978 C19.516,6.239 19.044,6.46 18.52,6.659 C16.702,7.351 14.231,7.771 12.288,8.563 C10.525,9.28 9.198,10.303 9.219,12.13 C19.661,11.085 31.103,12.735 40.727,17.008 C40.004,17.091 39.292,17.191 38.58,17.291 C31.755,18.251 25.482,20.019 20.95,22.41 C20.737,22.521 20.535,22.641 20.326,22.756 C6.29,30.517 2.621,45.688 6.392,66.831 C10.112,87.614 26.1589994,162.759995 31.9999994,190.999995 C41.6029994,193.778995 50.5819993,195.999995 61.0799993,195.999995 C69.9919993,195.999995 80.7110013,194.024995 89.0000013,191.999995 C86.0890013,186.386995 82.344,180.18 80.036,175.729 C79.728,176.096 79.485,176.417 79.184,176.618 Z M85.057,70.057 C81.253,70.057 78.15,66.963 78.15,63.137 C78.15,59.329 81.253,56.234 85.057,56.234 C88.882,56.234 91.973,59.329 91.973,63.137 C91.973,66.963 88.882,70.057 85.057,70.057 L85.057,70.057 Z M89.218,44.049 C89.218,44.049 84.861,41.56 81.48,41.602 C74.532,41.693 72.64,44.763 72.64,44.763 C72.64,44.763 73.806,37.445 82.691,38.913 C87.508,39.714 89.218,44.049 89.218,44.049 L89.218,44.049 Z M15.963,53.046 C15.963,53.046 12.834,46.073 21.173,42.656 C29.521,39.238 33.586,44.601 33.586,44.601 C33.586,44.601 27.524,41.859 21.63,45.563 C15.746,49.263 15.963,53.046 15.963,53.046 L15.963,53.046 Z M23.253,67.908 C23.253,63.462 26.848,59.864 31.3,59.864 C35.74,59.864 39.34,63.462 39.34,67.908 C39.34,72.355 35.74,75.949 31.3,75.949 C26.848,75.951 23.253,72.355 23.253,67.908 L23.253,67.908 Z" fill="#FFFFFF"></path><path d="M39.34,67.908 C39.34,63.462 35.74,59.864 31.3,59.864 C26.848,59.864 23.253,63.462 23.253,67.908 C23.253,72.355 26.848,75.951 31.3,75.949 C35.74,75.949 39.34,72.355 39.34,67.908 L39.34,67.908 Z M34.862,67.317 C33.72,67.32 32.781,66.381 32.781,65.227 C32.781,64.07 33.717,63.139 34.862,63.139 C36.016,63.139 36.952,64.07 36.952,65.227 C36.952,66.381 36.016,67.317 34.862,67.317 L34.862,67.317 Z" fill="#2D4F8E"></path><path d="M34.862,63.139 C33.717,63.139 32.781,64.07 32.781,65.227 C32.781,66.381 33.72,67.32 34.862,67.317 C36.016,67.317 36.952,66.381 36.952,65.227 C36.952,64.07 36.016,63.139 34.862,63.139" fill="#FFFFFF"></path><path d="M85.057,56.234 C81.253,56.234 78.15,59.329 78.15,63.137 C78.15,66.963 81.253,70.057 85.057,70.057 C88.882,70.057 91.973,66.963 91.973,63.137 C91.973,59.329 88.882,56.234 85.057,56.234 L85.057,56.234 Z M88.124,62.628 C87.149,62.628 86.344,61.835 86.344,60.839 C86.344,59.856 87.149,59.049 88.124,59.049 C89.141,59.049 89.921,59.856 89.921,60.839 C89.921,61.835 89.141,62.628 88.124,62.628 L88.124,62.628 Z" fill="#2D4F8E"></path><path d="M88.124,59.049 C87.149,59.049 86.344,59.856 86.344,60.839 C86.344,61.835 87.149,62.628 88.124,62.628 C89.141,62.628 89.921,61.835 89.921,60.839 C89.921,59.856 89.141,59.049 88.124,59.049" fill="#FFFFFF"></path><path d="M33.586,44.601 C33.586,44.601 29.521,39.238 21.173,42.656 C12.834,46.073 15.963,53.046 15.963,53.046 C15.963,53.046 15.746,49.263 21.63,45.563 C27.524,41.859 33.586,44.601 33.586,44.601" fill="url(#linearGradient-1)"></path><path d="M82.691,38.913 C73.806,37.445 72.64,44.763 72.64,44.763 C72.64,44.763 74.532,41.693 81.48,41.602 C84.861,41.56 89.218,44.049 89.218,44.049 C89.218,44.049 87.508,39.714 82.691,38.913" fill="url(#linearGradient-1)"></path><path d="M78.2,84.299 C69.297,84.855 56.723,94.061 55.917,98.927 C54.871,105.32 59.894,111.445 63.684,114.086 C63.694,114.093 63.705,114.102 63.715,114.109 C67.504,116.745 92.733,125.256 105.25,125.02 C117.781,124.776 138.361,117.102 136.101,110.953 C133.851,104.802 113.412,116.38 92.094,114.404 C76.306,112.937 73.519,105.864 77.015,100.698 C81.412,94.205 89.421,101.93 102.631,97.977 C115.861,94.035 134.363,86.979 141.228,83.137 C157.101,74.288 134.586,70.618 129.268,73.073 C124.227,75.402 106.681,79.83 98.547,81.793 C98.119,81.896 97.71,81.994 97.338,82.083 C89.904,83.863 87.123,83.736 78.2,84.299" fill="#FDD209"></path></g><g transform="translate(100.000000, 189.000000)"><path d="M24.316,17.97 C24.316,17.049 25.057,16.234 26.233,15.539 C26.266,14.98 26.57,14.46 27.08,13.983 C18.707,9.82 1.495,1.883 1.126,6.783 C0.62,13.274 1.126,39.724 4.616,41.725 C6.85,42.999 17.85,37.345 25.499,33.098 C23.292,31.217 24.316,26.651 24.316,17.97" fill="#65BC46"></path><path d="M45.925,28.686 C45.961,28.7 46,28.715 46.036,28.729 C52.89,31.374 66.534,36.353 69.497,35.266 C73.492,33.739 72.492,1.813 68.008,0.796 C64.416,-0.001 50.665,9.688 45.255,13.635 C46.212,17.676 47.37,25.68 45.925,28.686" fill="#65BC46"></path><path d="M29.214,31.611 C24.719,30.615 26.221,26.118 26.221,15.64 C26.221,15.606 26.231,15.573 26.233,15.539 C25.057,16.234 24.316,17.049 24.316,17.97 C24.316,26.651 23.292,31.217 25.499,33.098 C25.955,33.487 26.539,33.77 27.31,33.941 C31.79,34.945 40.275,33.941 43.279,31.948 C43.782,31.614 44.127,30.95 44.353,30.074 C40.837,31.758 33.329,32.547 29.214,31.611" fill="#43A244"></path><path d="M27.08,13.983 C26.57,14.46 26.266,14.98 26.233,15.539 C26.231,15.573 26.221,15.606 26.221,15.64 C26.221,26.118 24.719,30.615 29.214,31.611 C33.329,32.547 40.837,31.758 44.353,30.074 C44.658,29.928 44.944,29.778 45.184,29.618 C45.485,29.417 45.728,29.096 45.925,28.686 C47.37,25.68 46.212,17.676 45.255,13.635 C45.044,12.746 44.844,12.046 44.683,11.636 C44.27,10.614 41.089,10.351 37.48,10.704 C33.466,11.097 28.931,12.254 27.08,13.983" fill="#65BC46"></path></g></svg></button>
      <button type="button" onclick="searchGoogleMaps()"><svg viewBox="0 0 512 512"><path d="m307.79 223.476-53.135 78.467-78.573 78.18c-29.222-37.139-61.132-73.116-80.587-116.631l42.352-64.879 64.957-62.668c-21.71 26.831-20.089 66.293 4.864 91.246 26.696 26.696 69.968 26.696 96.663 0 1.203-1.203 2.365-2.446 3.459-3.715z" fill="#ecb72b"></path><path d="m309.02 222.003c21.9-26.844 20.346-66.442-4.688-91.462-26.696-26.696-69.968-26.696-96.663 0-1.121 1.121-2.189 2.27-3.215 3.445l44.811-72.847 60.795-52.809c45.407 14.374 82.964 46.379 104.648 87.977l-44.352 71.516z" fill="#5085f7"></path><path d="m202.802 135.949-107.312 127.549c-10.643-23.783-17.562-49.817-18.276-79.529-.054-1.689-.081-3.391-.081-5.093 0-43.718 15.685-83.789 41.746-114.861z" fill="#da2f2a"></path><path d="m202.802 135.949-83.926-71.939c32.816-39.125 82.06-64.01 137.126-64.01 18.845 0 37.009 2.916 54.065 8.32z" fill="#4274eb"></path><path d="m434.867 178.865c0-29.779-7.278-57.859-20.151-82.558l-238.64 283.826c27.113 34.488 51.887 69.985 62.183 113.454.33 1.392.685 3.019 1.063 4.848 3.733 18.086 29.63 18.086 33.363 0 .378-1.829.733-3.456 1.063-4.848 27.448-115.892 157.807-175.118 161.043-309.618.046-1.696.076-3.397.076-5.104z" fill="#60a850"></path></svg></button>
      <button type="button" onclick="searchYoutube()"><svg viewBox="-21 -117 682.66672 682" fill="#FF0000"><path d="m626.8125 64.035156c-7.375-27.417968-28.992188-49.03125-56.40625-56.414062-50.082031-13.703125-250.414062-13.703125-250.414062-13.703125s-200.324219 0-250.40625 13.183593c-26.886719 7.375-49.03125 29.519532-56.40625 56.933594-13.179688 50.078125-13.179688 153.933594-13.179688 153.933594s0 104.378906 13.179688 153.933594c7.382812 27.414062 28.992187 49.027344 56.410156 56.410156 50.605468 13.707031 250.410156 13.707031 250.410156 13.707031s200.324219 0 250.40625-13.183593c27.417969-7.378907 49.03125-28.992188 56.414062-56.40625 13.175782-50.082032 13.175782-153.933594 13.175782-153.933594s.527344-104.382813-13.183594-154.460938zm-370.601562 249.878906v-191.890624l166.585937 95.945312zm0 0"></path></svg></button>
    </label>


    <div id="destacado" onmousedown="startDrag(event)" onmousemove="onDrag(event)" onmouseup="endDrag()" onmouseleave="endDrag()"></div>

    <div class="marcadores">
      <h2>Marcadores</h2>
      <div id="grupos"></div>
    </div>

    <footer>
      <button onclick="activarModoEditor()">Modo editor</button>
    </footer>
  </div>


  <div class="edit">
    <header>
      <button onclick="updatePHP()">
        <svg viewBox="0 0 95.43 93.4"><path d="M88.19,2.32h0c-3.45,0-6.24,2.79-6.24,6.24v9.66C73.58,7.73,60.68,1,46.22,1,23.42,1,4.52,17.69,1.08,39.51c-.6,3.78,2.35,7.19,6.17,7.19,3.07,0,5.67-2.24,6.16-5.27,2.52-15.85,16.25-27.96,32.81-27.96,11.07,0,20.87,5.42,26.9,13.74h-9.83c-3.45,0-6.24,2.79-6.24,6.24s2.79,6.24,6.24,6.24h24.9c3.45,0,6.24-2.79,6.24-6.24V8.56c0-3.45-2.79-6.24-6.24-6.24Z" style="fill: #a6ceef; stroke: #008ed0; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="M7.24,91.08h0c3.45,0,6.24-2.79,6.24-6.24v-9.66c8.37,10.49,21.26,17.22,35.73,17.22,22.79,0,41.69-16.69,45.14-38.51.6-3.78-2.35-7.19-6.17-7.19-3.07,0-5.67,2.24-6.16,5.27-2.52,15.85-16.25,27.96-32.81,27.96-11.07,0-20.87-5.42-26.9-13.74h9.83c3.45,0,6.24-2.79,6.24-6.24s-2.79-6.24-6.24-6.24H7.24c-3.45,0-6.24,2.79-6.24,6.24v24.9c0,3.45,2.79,6.24,6.24,6.24Z" style="fill: #a6ceef; stroke: #008ed0; stroke-miterlimit: 10; stroke-width: 2px;"/></svg> 
        <p>Actualizar</p>
      </button>
      <button onclick="saveHTML()">
        <svg viewBox="0 0 512 512"><polygon fill="#F8F8F9" points="345.6,0 51.2,0 51.2,512 460.8,512 460.8,115.2 "></polygon><polygon fill="#F8F8F9" points="345.6,115.2 345.6,0 256,0 256,512 460.8,512 460.8,115.2 "></polygon><rect x="25.6" y="230.4" fill="#e54c21" width="460.8" height="204.8"></rect><rect x="256" y="230.4" fill="#e54c21" width="230.4" height="204.8"></rect><path fill="#F8F8F9" d="M165.11,289.408V371.2h-18.895v-33.523h-32.599V371.2H94.723v-81.792h18.893v31.68h32.6v-31.68H165.11z"></path><path fill="#F8F8F9" d="M248.859,305.997h-24.882V371.2h-18.893v-65.203h-24.998v-16.589h68.773L248.859,305.997L248.859,305.997z"></path><path fill="#F8F8F9" d="M328.346,371.2v-48.96l-17.74,35.597h-10.138l-17.741-35.597v48.96h-18.893v-81.792h20.506l21.197,42.739l21.312-42.739h20.392V371.2H328.346z"></path><path fill="#F8F8F9" d="M368.663,371.2v-81.792h18.894v65.203h39.629V371.2H368.663z"></path></svg>
        <p>Guardar</p>
      </button>
      <button onclick="Importar()">
        <svg viewBox="-28.4 0 512 512"><polygon fill="#fff" points="436.4 501.7 60.1 501.7 60.1 16.3 319.2 16.3 436.4 122 436.4 501.7"></polygon><polygon fill="#f5ce85" points="323 16.3 319.2 16.3 319.2 122 436.4 122 323 16.3"></polygon><polygon fill="#f5ce85" points="16.3 208.8 16.3 306.5 156.5 306.5 156.5 370.9 298.2 256 156.5 141.1 156.5 208.8 16.3 208.8"></polygon><path transform="translate(-28.4)" fill="#967a44" d="M467.3,202.7A16.3,16.3,0,0,0,451,219V479.4H105.8V322.8h62.9v48.1a16.4,16.4,0,0,0,9.2,14.7,17.8,17.8,0,0,0,7,1.6,16.5,16.5,0,0,0,10.3-3.7L336.8,268.6a16.1,16.1,0,0,0,0-25.2L195.2,128.5a16.3,16.3,0,0,0-26.6,12.6v51.4H44.7a16.3,16.3,0,0,0-16.3,16.3v97.7a16.3,16.3,0,0,0,16.3,16.3H73.3V495.7A16.2,16.2,0,0,0,89.5,512H467.3a16.3,16.3,0,0,0,16.3-16.3V219A16.3,16.3,0,0,0,467.3,202.7ZM61,225.1H184.9a16.3,16.3,0,0,0,16.3-16.3V175.3L300.7,256l-99.5,80.7V306.5a16.3,16.3,0,0,0-16.3-16.3H61Z"></path><path transform="translate(-28.4)" fill="#967a44" d="M89.5,138.3A16.3,16.3,0,0,0,105.8,122V32.6H331.3V122a16.3,16.3,0,0,0,16.3,16.3H464.8a16.3,16.3,0,0,0,11.1-28.2L362.5,4.4c-.1-.1-.3-.2-.4-.4l-.6-.4-.6-.5-.6-.5-.7-.3-.7-.5-.6-.2-.8-.4-.6-.2L356,.7l-.6-.2-.9-.2H89.5A16.2,16.2,0,0,0,73.3,16.3V122A16.2,16.2,0,0,0,89.5,138.3Zm274.4-32.5V50.2l59.5,55.6Z"></path></svg>
        <p>Importar</p>
      </button>
      <button onclick="Exportar()">
        <svg viewBox="-28.4 0 512 512"><polygon fill="#fff" points="436.9 498.7 60.6 498.7 60.6 13.3 319.7 13.3 436.9 119 436.9 498.7"></polygon><polygon fill="#c2e8ff" points="323 16.3 319.2 16.3 319.2 122 436.4 122 323 16.3"></polygon><polygon fill="#c2e8ff" points="298.2 303.2 298.2 205.5 157.9 205.5 157.9 141.1 16.3 256 157.9 370.9 157.9 303.2 298.2 303.2"></polygon><path transform="translate(-28.4)" fill="#4e7ab5" d="M467.3,202.7A16.2,16.2,0,0,0,451.1,219V479.4H105.8V326.6l70.3,56.9a16,16,0,0,0,10.2,3.7,17.1,17.1,0,0,0,7-1.6,16.2,16.2,0,0,0,9.3-14.7V319.5h124a16.3,16.3,0,0,0,16.3-16.3V205.5a16.3,16.3,0,0,0-16.3-16.3h-124V141.1a16.2,16.2,0,0,0-26.5-12.6L34.4,243.4a16.2,16.2,0,0,0,0,25.2l38.9,31.6V495.7A16.2,16.2,0,0,0,89.5,512H467.3a16.3,16.3,0,0,0,16.3-16.3V219A16.3,16.3,0,0,0,467.3,202.7ZM170,175.3v30.2a16.3,16.3,0,0,0,16.3,16.3h124v65.1h-124A16.3,16.3,0,0,0,170,303.2v33.5L70.5,256Z"></path><path transform="translate(-28.4)" fill="#4e7ab5" d="M89.5,138.3A16.3,16.3,0,0,0,105.8,122V32.6H331.3V122a16.3,16.3,0,0,0,16.3,16.3H464.8a16.3,16.3,0,0,0,11.1-28.2L362.5,4.4c-.1-.1-.3-.2-.4-.4l-.6-.4-.6-.5-.6-.5-.7-.3-.7-.5-.6-.2-.8-.4-.6-.2L356,.7l-.6-.2-.9-.2H89.5A16.3,16.3,0,0,0,73.3,16.3V122A16.3,16.3,0,0,0,89.5,138.3Zm274.4-32.5V50.2l59.5,55.6Z"></path></svg>
        <p>Exportar</p></button>
      <button  onclick="document.body.classList.remove('editor')">
        <svg viewBox="0 0 529.69 529.69" fill="red"><rect x="227.35" y="-72.2" width="75" height="674.1" transform="translate(-109.7 264.85) rotate(-45)"/><rect x="227.35" y="-72.2" width="75" height="674.1" transform="translate(264.85 -109.7) rotate(45)"/></svg>
        <p>Cancelar</p>
      </button>
    </header>

    <div id="destacadoEdit">
      <h2>Destacados</h2>
      <div class="list"></div>
    </div>

    <div id="marcadoresEdit"><h2>Marcadores</h2>

    </div>

    <div id="loadIMG">
      <div class="back" onclick="document.getElementById('loadIMG')?.classList.remove('active');"></div>
      <div class="windows">
        <h4>Cargar imagen</h4>
        <div class="img"></div>
        <div class="option">
          <input type="text" name="URL" placeholder="URL" oninput="actualizarIMGDesdeURL(this)" onchange="actualizarIMGDesdeURL(this)">
          <input type="button" value="Subir" onclick="subirArchivoIMG()">
        </div>
      </div>
    </div>

  </div>
  <script>
    // -------------------------------------------------------------------
    // Cargar marcadores del JSON marcadoresJSON
    // -------------------------------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
      // Rellenar DESTACADO
      const contDest = document.getElementById('destacado');
      contDest.innerHTML = marcadoresJSON.destacado
        .map(m => `
          <a class="marcador" href="${m.url}" title="${m.name}" draggable="false">
            <div class="img"${ m.img ? ` style="background-image: url('${m.img}');"` : '' }></div>
          </a>
        `).join('');

      // Rellenar GRUPOS
      const contGrupos = document.getElementById('grupos');
      contGrupos.innerHTML = marcadoresJSON.marcadores
        .map(g => `
          <div class="grupo">
            <h3>${g.grupo}</h3>
            ${ g.marcadores.map(m => `
              <a class="marcador" href="${m.url}">
                <div class="img"${ m.img ? ` style="background-image: url('${m.img}');"` : '' }></div>
                <p>${m.name}</p>
              </a>
            `).join('') }
          </div>
        `).join('');
    });


    // -------------------------------------------------------------------
    // Buscador con funcion de filtrado de marcadores
    // -------------------------------------------------------------------
    // Cuando se pulsa enter hace una busqueda en google de lo escrito
    function buscar(e) {
      if (e.charCode === 13) {
        e.preventDefault();
        const entrada = e.target.value.trim();
        if (entrada.length > 0) {
          window.open("https://www.google.com/search?q=" + encodeURIComponent(entrada), "_top");
        }
      }
    }

    // Filtra los marcadores
    function filtrarMarcadores() {
      const filtro = document.getElementById("searchInput").value.trim().toUpperCase();

      document.querySelectorAll(".grupo").forEach(grupo => {
        grupo.querySelectorAll(".marcador").forEach(marcador => {
          const texto = marcador.querySelector("p")?.textContent.toUpperCase() || "";
          marcador.style.display = texto.includes(filtro) ? "" : "none";
        });
      });
    }


    // -------------------------------------------------------------------
    // Buscador
    // -------------------------------------------------------------------
    // Buscar con Google
    function searchGoogle() {
        var b = document.getElementById("searchInput").value;
        if (b == "") {
            window.location.href = "https://www.google.com/"
        } else {
            window.location.href = "https://www.google.com/search?q=" + encodeURIComponent(b)
        }
    }

    // Buscar con DuckDuckGo
    function searchDuckDuckGo() {
        var b = document.getElementById("searchInput").value;
        if (b == "") {
            window.location.href = "https://duckduckgo.com/"
        } else {
            window.location.href = "https://duckduckgo.com/?q=" + encodeURIComponent(b)
        }
    }

    // Buscar con Google Maps
    function searchGoogleMaps() {
        var b = document.getElementById("searchInput").value;
        if (b == "") {
            window.location.href = "https://www.google.com/maps"
        } else {
            window.location.href = "https://www.google.com/maps?q=" + encodeURIComponent(b)
        }
    }

    // Buscar con YouTube
    function searchYoutube() {
        var b = document.getElementById("searchInput").value;
        if (b == "") {
            window.location.href = "https://www.youtube.com/feed/subscriptions"
        } else {
            window.location.href = "https://www.youtube.com/results?search_query=" + encodeURIComponent(b)
        }
    };


    // -------------------------------------------------------------------
    // Sistema para desplazarse en elementos horizontales con el raton
    // -------------------------------------------------------------------
    let isDown, startX, scrollStart, sliderEl;
    function startDrag(e) {
        isDown = true;
        sliderEl = e.currentTarget;
        startX = e.clientX;
        scrollStart = sliderEl.scrollLeft;
        console.log(`Inicio click: x=${startX}`);
    }
    function onDrag(e) {
        if (!isDown) return;
        const x = e.clientX;
        sliderEl.scrollLeft = scrollStart - (x - startX);
    }
    function endDrag() {
        if (!isDown) return;
        isDown = false;
    }
    /* Los elementos contenedores deben tener <div onmousedown="startDrag(event)" onmousemove="onDrag(event)" onmouseup="endDrag()" onmouseleave="endDrag()"> */


    // -------------------------------------------------------------------
    // Convertir a JSON
    // -------------------------------------------------------------------
    function ViewToJson() {
      const resultado = { destacado: [], marcadores: [] };

      // Extraer destacados
      document.querySelectorAll("#destacado a").forEach(a => {
        const imgUrl = (a.querySelector(".img")?.style.backgroundImage || "").slice(5, -2) || "";
        const name = a.title || "";
        const url = a.getAttribute("href") || "";
        resultado.destacado.push({img: imgUrl, name: name, url: url});
      });

      // Extraer grupos de marcadores
      document.querySelectorAll(".view .marcadores .grupo").forEach(grupo => {
        const nombreGrupo = grupo.querySelector("h3")?.textContent.trim() || "";
        const marcadores = [];

        grupo.querySelectorAll("a.marcador").forEach(a => {
          const imgUrl = a.querySelector(".img")?.style.backgroundImage.match(/url\(["']?(.*?)["']?\)/)?.[1] || "";
          const name = a.querySelector("p")?.textContent.trim() || "";
          const url = a.getAttribute("href") || "";
          marcadores.push({img: imgUrl, name: name, url: url});
        });

        resultado.marcadores.push({grupo: nombreGrupo, marcadores: marcadores});
      });

      return resultado;
    }
    
    function EditToJson() {
      const resultado = { destacado: [], marcadores: [] };
      const extraerBackgroundUrl = (style) => {const match = style?.match(/url\(['"]?(.*?)['"]?\)/); return match?.[1] || "";};
      const procesarMarcador = (marcador) => {
        const name = marcador.querySelector('input[type="text"]')?.value.trim();
        if (!name) return null;
        const style = marcador.querySelector(".img")?.style.backgroundImage || "";
        const img = extraerBackgroundUrl(style);
        const url = marcador.querySelector('input[type="url"]')?.value.trim() || "";
        return { img, name, url };
      };

      // Extraer destacados
      document.querySelectorAll("#destacadoEdit .list .marcador").forEach(marcador => {
        const data = procesarMarcador(marcador);
        if (data) resultado.destacado.push(data);
      });

      // Extraer marcadores por grupo
      document.querySelectorAll("#marcadoresEdit .grupo").forEach(grupo => {
        const nombreGrupo = grupo.querySelector(".gru input[type='text']")?.value.trim();
        if (!nombreGrupo) return;
        const marcadores = Array.from(grupo.querySelectorAll(".list .marcador")).map(procesarMarcador).filter(Boolean);
        if (marcadores.length) {resultado.marcadores.push({ grupo: nombreGrupo, marcadores });}
      });

      return resultado;
    }


    // -------------------------------------------------------------------
    // Plantilla de grupo y marcador
    // -------------------------------------------------------------------
    function crearMarcadorHTML(data = {}) {
      return `
        <div class="marcador" draggable="true" ondragstart="onDragStartIMG(event)" ondragover="onDragOverMarcador(event)" ondragleave="onDragLeaveMarcador(event)" ondrop="onDropMarcador(event)">
          <div class="img" style="${data.img ? `background-image: url('${data.img}')` : ''}"></div>
          <button  onclick="abrirLoadIMG(this)">Cargar imagen</button>
          <input onchange="handleInputChange(this)" onfocus="toggleDraggable(this, false)" onblur="toggleDraggable(this, true)" type="text" placeholder="Texto" value="${data.name || ''}">
          <input onchange="handleInputChange(this)" onfocus="toggleDraggable(this, false)" onblur="toggleDraggable(this, true)" type="url" placeholder="URL" value="${data.url || ''}">
          <button class="DelAdd" onclick="handleDelAdd(this)"><i></i></button>
        </div>
      `;
    }

    function crearGrupoHTML(grupo = {}) {
      return `
        <div class="grupo" draggable="true" ondragstart="onDragStartGrupo(event)" ondragover="onDragOverGrupo(event)" ondragleave="onDragLeaveGrupo(event)" ondrop="onDropGrupo(event)">
          <div class="gru">
            <input type="text" value="${grupo.grupo || ''}" placeholder="Grupo">
            <button class="DelAdd" onclick="grupoHandleDelAdd(this)"><i></i></button>
          </div>
          <div class="list">
            ${(grupo.marcadores || []).map(m => crearMarcadorHTML(m)).join('')}
            ${crearMarcadorHTML()}
          </div>
        </div>
      `;
    }


    // -------------------------------------------------------------------
    // Pasar JSON a editor
    // -------------------------------------------------------------------
    function JsonAEdit(datos) {
      // === DESTACADO ===
      const listDest = document.querySelector("#destacadoEdit .list");
      listDest.innerHTML = "";
      datos.destacado.forEach(item => listDest.insertAdjacentHTML("beforeend", crearMarcadorHTML(item)));
      listDest.insertAdjacentHTML("beforeend", crearMarcadorHTML());

      // === MARCADORES ===
      const contMarcadores = document.querySelector("#marcadoresEdit");
      contMarcadores.innerHTML = "<h2>Marcadores</h2>";

      datos.marcadores.forEach(grupo => {contMarcadores.insertAdjacentHTML("beforeend", crearGrupoHTML(grupo));});

      // Grupo vacío final
      contMarcadores.insertAdjacentHTML("beforeend", crearGrupoHTML());
    }


    // -------------------------------------------------------------------
    // Pasar al modo editor
    // -------------------------------------------------------------------
    function activarModoEditor() {
      document.body.classList.add("editor");
      const datos = ViewToJson();
      JsonAEdit(datos);
    }


    // -------------------------------------------------------------------
    // Opciones de importado, exportado y actualizacion
    // -------------------------------------------------------------------
    // Actualizar la pagina actual en conjunto el PHP
    function updatePHP() {
      const clave = prompt('Introduce la clave de edición:');
      if (!clave) {
        alert('Clave cancelada.');
        return;
      }

      fetch('./update.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ clave, contenido: EditToJson() })
      })
      .then(res => res.json())
      .then(res => {
        if (res.success) location.reload();
        else alert('Error: ' + (res.error || 'No se pudo guardar.'));
      })
      .catch(() => alert('Error de conexión con el servidor.'));
    }

    // Descargar la pagina con los cambios realizados
    async function saveHTML() {
      try {
        // 1) Parsear el HTML original sin variables intermedias
        const doc = new DOMParser().parseFromString(
          await (await fetch(window.location.href, { cache: 'no-store' })).text(),
          'text/html'
        );

        // 2) Sustituir el JSON directamente
        const script = doc.getElementById('marcadoresJSON');
        if (script) {
          script.textContent = 'const marcadoresJSON = ' + JSON.stringify(EditToJson(), null, 2) + ';';
        }

        // 3) Serializar y guardar con File System Access API
        const nuevoHTML = new XMLSerializer().serializeToString(doc);
        const handle = await window.showSaveFilePicker({
          suggestedName: 'index.html',
          types: [{ description: 'HTML', accept: { 'text/html': ['.html'] } }]
        });
        const writable = await handle.createWritable();
        await writable.write(nuevoHTML);
        await writable.close();

        alert('Guardado correcto.');
      } catch {
        alert('No se pudo guardar el archivo.');
      }
    }

    // Cargar el JSON
    function Importar() {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = "application/json";

      input.onchange = () => {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          try {JsonAEdit(JSON.parse(reader.result));}
          catch {alert("El archivo no contiene un JSON válido.");}
        };
        reader.readAsText(file);
      };

      input.click();
    }

    // Descargar el JSON de los cambios realizados
    function Exportar() {
      const datos = EditToJson();
      const blob = new Blob([JSON.stringify(datos, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);

      const ahora = new Date();
      const pad = n => n.toString().padStart(2, '0');
      const nombreArchivo = `${ahora.getFullYear()}-${pad(ahora.getMonth() + 1)}-${pad(ahora.getDate())}_` + `${pad(ahora.getHours())}-${pad(ahora.getMinutes())}-${pad(ahora.getSeconds())}_marcadores.json`;

      const a = document.createElement('a');
      a.href = url;
      a.download = nombreArchivo;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }


    // -------------------------------------------------------------------
    // Boton de añadir y eliminar
    // -------------------------------------------------------------------
    // Añadir grupo o eliminarlo
    function grupoHandleDelAdd(btn) {
      const grupo = btn.closest('.grupo');
      const container = grupo.parentElement;
      const grupos = Array.from(container.querySelectorAll('.grupo'));

      if (!(grupos.indexOf(grupo) === grupos.length - 1)) {grupo.remove(); return;}

      // Crear nuevo grupo con innerHTML
      contenedor.insertAdjacentHTML('beforeend', crearGrupoHTML());
    }

    // Añadir marcador o eliminarlo
    function handleDelAdd(btn) {
      const marcador = btn.closest('.marcador');
      const list = marcador?.parentElement;
      const marcadores = Array.from(list.querySelectorAll('.marcador'));

      if (!(marcadores.indexOf(marcador) === marcadores.length - 1)) {marcador.remove(); return;}

      // Crear nuevo marcador con innerHTML en un div (no 'a')
      list.insertAdjacentHTML('beforeend', crearMarcadorHTML());

      formatearGrupos();
    }


    // -------------------------------------------------------------------
    // Evento al rellenar un input, añadir nuevo marcador
    // -------------------------------------------------------------------
    function handleInputChange(input) {
      const marcador = input.closest('.marcador');
      const list = marcador?.parentElement;
      const esUltimo = marcador === list.querySelector('.marcador:last-of-type');

      if (!esUltimo) return;

      // Comprobar si es el único marcador en la lista
      const marcadores = list.querySelectorAll('.marcador');
      const esUnicoMarcador = marcadores.length === 1;

      if (esUnicoMarcador) {
        const grupo = input.closest('.grupo');
        const container = grupo?.parentElement;
        if (container) {container.insertAdjacentHTML('beforeend', crearGrupoHTML());}
      }

      // Añadir nuevo marcador al final
      list.insertAdjacentHTML('beforeend', crearMarcadorHTML());
    }


    // -------------------------------------------------------------------
    // Prevenir arrastrar mientras se selecciona el input
    // -------------------------------------------------------------------
    function toggleDraggable(input, activar) {
      input.closest('.marcador').draggable = activar;
      input.closest('.grupo').draggable = activar;
    }


    // -------------------------------------------------------------------
    // Arrastrar marcadores
    // -------------------------------------------------------------------
    // Variables para drag marcadores
    let marcadorArrastrado = null;
    let insertarArriba = false;

    // Inicia el arrastre de un marcador (.marcador)
    function onDragStartIMG(e) {
      marcadorArrastrado = e.target.closest('.marcador');
      grupoArrastrado = null;
      marcadorArrastrado.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    }

    // Se activa al pasar por encima de otro marcador
    function onDragOverMarcador(e) {
      e.preventDefault();
      if (!grupoArrastrado && marcadorArrastrado) {
        const sobre = e.target.closest('.marcador');
        if (!sobre || sobre === marcadorArrastrado) return;

        document.querySelectorAll('.moveUP, .moveDOWN').forEach(el => el.classList.remove('moveUP', 'moveDOWN'));

        const rect = sobre.getBoundingClientRect();
        insertarArriba = (e.clientY - rect.top) < rect.height / 2;
        sobre.classList.add(insertarArriba ? 'moveUP' : 'moveDOWN');
      }
    }

    // Se activa al salir de un marcador, elimina clases visuales
    function onDragLeaveMarcador(e) {
      const marcador = e.target.closest('.marcador');
      marcador?.classList.remove('moveUP', 'moveDOWN');
    }

    // Al soltar un marcador sobre otro, realiza el movimiento
    function onDropMarcador(e) {
      e.preventDefault();
      if (!grupoArrastrado && marcadorArrastrado) {
        const destino = e.target.closest('.marcador');
        const lista = destino?.parentElement;

        document.querySelectorAll('.moveUP, .moveDOWN').forEach(el => el.classList.remove('moveUP', 'moveDOWN'));

        if (!destino || marcadorArrastrado === destino) return;

        if (insertarArriba) {lista.insertBefore(marcadorArrastrado, destino);}
        else {lista.insertBefore(marcadorArrastrado, destino.nextSibling);}

        marcadorArrastrado.classList.remove('dragging');
        marcadorArrastrado = null;

        formatearListas?.(); // Función opcional para reordenar o actualizar
      }
    }


    // -------------------------------------------------------------------
    // Arrastrar grupos
    // -------------------------------------------------------------------
    // Variables para drag grupos
    let grupoArrastrado = null;
    let insertarArribaGrupo = false;

    // Inicia el arrastre de un grupo (.grupo)
    function onDragStartGrupo(e) {
      // Si estamos arrastrando un marcador, no iniciar arrastre de grupo
      if (marcadorArrastrado) return;

      grupoArrastrado = e.currentTarget;
      marcadorArrastrado = null;
      grupoArrastrado.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    }

    // Se activa al pasar por encima de otro grupo
    function onDragOverGrupo(e) {
      e.preventDefault();
      if (!marcadorArrastrado && grupoArrastrado) {
        const sobre = e.currentTarget;
        if (!sobre || sobre === grupoArrastrado) return;

        document.querySelectorAll('.moveUP, .moveDOWN').forEach(el => el.classList.remove('moveUP', 'moveDOWN'));

        const rect = sobre.getBoundingClientRect();
        insertarArribaGrupo = (e.clientY - rect.top) < rect.height / 2;
        sobre.classList.add(insertarArribaGrupo ? 'moveUP' : 'moveDOWN');
      }
    }

    // Se activa al salir de un grupo, elimina clases visuales
    function onDragLeaveGrupo(e) {
      const grupo = e.currentTarget;
      grupo?.classList.remove('moveUP', 'moveDOWN');
    }

    // Al soltar un grupo sobre otro, realiza el movimiento
    function onDropGrupo(e) {
      e.preventDefault();
      if (!marcadorArrastrado && grupoArrastrado) {
        const destino = e.currentTarget;
        const contenedor = destino?.parentElement;

        document.querySelectorAll('.moveUP, .moveDOWN').forEach(el => el.classList.remove('moveUP', 'moveDOWN'));

        if (!destino || grupoArrastrado === destino) return;

        if (insertarArribaGrupo) {contenedor.insertBefore(grupoArrastrado, destino);}
        else {contenedor.insertBefore(grupoArrastrado, destino.nextSibling);}

        grupoArrastrado.classList.remove('dragging');
        grupoArrastrado = null;

        formatearListas();
      }
    }


    // -------------------------------------------------------------------
    // Revizar que haya un ultimo marcador en blanco para añadir
    // -------------------------------------------------------------------
    function formatearListas() {
      document.querySelectorAll('.moveUP, .moveDOWN').forEach(el => { el.classList.remove('moveUP', 'moveDOWN'); });
      document.querySelectorAll('.list').forEach(list => {
        const marcadores = list.querySelectorAll('.marcador');
        if (marcadores.length === 0) {
          list.insertAdjacentHTML('beforeend', crearMarcadorHTML());
        } else {
          const ultimoMarcador = marcadores[marcadores.length - 1];
          const inputsNoVacios = Array.from(ultimoMarcador.querySelectorAll('input[type="text"], input[type="url"]'))
            .some(input => input.value.trim() !== '');
          const img = ultimoMarcador.querySelector('.img');
          const tieneImagen = img && img.style.backgroundImage && img.style.backgroundImage !== 'none';

          if (inputsNoVacios || tieneImagen) {
            list.insertAdjacentHTML('beforeend', crearMarcadorHTML());
          }
        }
      });
      formatearGrupos();
    }

    function formatearGrupos() {
      const contenedor = document.querySelector('#marcadoresEdit');
      const ultimoGrupo = contenedor.querySelector('.grupo:last-of-type');
      if (!ultimoGrupo) return;
      if (ultimoGrupo.querySelectorAll('.list .marcador').length !== 1) {
        contenedor.insertAdjacentHTML('beforeend', crearGrupoHTML());
      }
    }


    // -------------------------------------------------------------------
    // Cargar imagen
    // -------------------------------------------------------------------
    let imgActual = null;

    // Abrir popup desde botón en marcador
    function abrirLoadIMG(btn) {
      // Guardamos la referencia al div.img del marcador actual
      imgActual = btn.closest('.marcador').querySelector('.img');
      
      const url = imgActual.style.backgroundImage.match(/url\(["']?(.*?)["']?\)/)?.[1] || '';

      document.getElementById('loadIMG').classList.add('active');
      document.getElementById('loadIMG').querySelector('.img').style.backgroundImage = url ? `url('${url}')` : '';
      document.getElementById('loadIMG').querySelector('input[name="URL"]').value = url;

      if (btn.closest('.marcador') === btn.closest('.list')?.querySelector('.marcador:last-of-type')) {
        btn.closest('.list').insertAdjacentHTML('beforeend', crearMarcadorHTML());
      }

      formatearGrupos();
    }

    // Al escribir una URL manualmente
    function actualizarIMGDesdeURL(input) {
      const url = input.value.trim();
      const bg = url ? `url('${url}')` : '';

      const preview = document.querySelector('#loadIMG .img');
      preview.style.backgroundImage = bg;

      if (imgActual) imgActual.style.backgroundImage = bg;
    }

    // Al pulsar "Subir"
    function subirArchivoIMG() {
      // Crear input tipo file que solo acepta imágenes
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = 'image/*';

      // Evento al seleccionar un archivo
      fileInput.onchange = () => {
        const file = fileInput.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = e => {
          const img = new Image();
          img.onload = () => {
            const maxSize = 300;
            let w = img.width, h = img.height;

            // Ajustar tamaño si ancho o alto superan maxSize manteniendo proporción
            if (w > maxSize || h > maxSize) {
              const scale = Math.min(maxSize / w, maxSize / h);
              w = Math.round(w * scale);
              h = Math.round(h * scale);
            }

            // Crear canvas con nuevo tamaño y dibujar la imagen escalada en el canvas
            const canvas = document.createElement('canvas');
            canvas.width = w;
            canvas.height = h;
            canvas.getContext('2d').drawImage(img, 0, 0, w, h);

            // Obtener la imagen redimensionada en base64 (PNG)
            const base64 = canvas.toDataURL('image/png');

            // Actualizar el input y elementos visuales con la imagen redimensionada
            const loadIMG = document.querySelector('#loadIMG');
            loadIMG.querySelector('input[name="URL"]').value = base64;
            loadIMG.querySelector('.img').style.backgroundImage = `url('${base64}')`;
            if (imgActual) imgActual.style.backgroundImage = `url('${base64}')`;
          };
          img.src = e.target.result; // Asignar la imagen cargada al objeto Image
        };
        reader.readAsDataURL(file); // Leer archivo como base64
      };
      fileInput.click(); // Abrir selector de archivos automáticamente
    }
  </script>
  <script id="marcadoresJSON">
const marcadoresJSON = {
    "destacado": [
        {
            "img": ".\/svg\/WhatsApp.svg",
            "name": "WhatsApp",
            "url": "https:\/\/web.telegram.org\/a\/"
        },
        {
            "img": ".\/svg\/Telegram.svg",
            "name": "Telegram",
            "url": "https:\/\/web.telegram.org\/a\/#788502985"
        },
        {
            "img": ".\/svg\/Discord.svg",
            "name": "Discord",
            "url": "https:\/\/discord.com\/channels\/@me"
        },
        {
            "img": ".\/svg\/Youtube.svg",
            "name": "YouTube",
            "url": "https:\/\/www.youtube.com\/feed\/subscriptions"
        },
        {
            "img": ".\/svg\/Twitch.svg",
            "name": "Twitch",
            "url": "https:\/\/www.twitch.tv\/"
        },
        {
            "img": "https:\/\/external-content.duckduckgo.com\/iu\/?u=https%3A%2F%2Fstatic.vecteezy.com%2Fsystem%2Fresources%2Fthumbnails%2F022%2F227%2F364%2Fsmall_2x%2Fopenai-chatgpt-logo-icon-free-png.png\u0026f=1\u0026nofb=1\u0026ipt=a70d942dafc5f691696f6d838ece4fa450db76eb4734091259c46e6cff33f45b",
            "name": "ChatGPT",
            "url": "https:\/\/chatgpt.com\/"
        },
        {
            "img": "https:\/\/www.gstatic.com\/lamda\/images\/gemini_favicon_f069958c85030456e93de685481c559f160ea06b.png",
            "name": "Google Gemini",
            "url": "https:\/\/gemini.google.com\/app"
        }
    ],
    "marcadores": [
        {
            "grupo": "Correo",
            "marcadores": [
                {
                    "img": "https:\/\/ssl.gstatic.com\/ui\/v1\/icons\/mail\/rfr\/gmail.ico",
                    "name": "Principal",
                    "url": "https:\/\/mail.google.com\/mail\/u\/0\/"
                },
                {
                    "img": "https:\/\/ssl.gstatic.com\/ui\/v1\/icons\/mail\/rfr\/gmail.ico",
                    "name": "Social",
                    "url": "https:\/\/mail.google.com\/mail\/u\/1\/"
                },
                {
                    "img": "https:\/\/ssl.gstatic.com\/ui\/v1\/icons\/mail\/rfr\/gmail.ico",
                    "name": "Trabajos y estudios",
                    "url": "https:\/\/mail.google.com\/mail\/u\/2\/"
                },
                {
                    "img": "https:\/\/ssl.gstatic.com\/ui\/v1\/icons\/mail\/rfr\/gmail.ico",
                    "name": "AntiSpam",
                    "url": "https:\/\/mail.google.com\/mail\/u\/3\/"
                },
                {
                    "img": "https:\/\/ssl.gstatic.com\/ui\/v1\/icons\/mail\/rfr\/gmail.ico",
                    "name": "FP Salesianos",
                    "url": "https:\/\/mail.google.com\/mail\/u\/4\/"
                }
            ]
        },
        {
            "grupo": "RRSS",
            "marcadores": [
                {
                    "img": ".\/svg\/RRSS.svg",
                    "name": "Mis redes sociales",
                    "url": "https:\/\/xaival.tumblr.com\/rrss"
                },
                {
                    "img": ".\/svg\/GitHub.svg",
                    "name": "GitHub",
                    "url": "https:\/\/github.com\/Xaival\/Proyectos-Web"
                },
                {
                    "img": ".\/svg\/Codepen.svg",
                    "name": "Codepen",
                    "url": "https:\/\/codepen.io\/your-work"
                },
                {
                    "img": ".\/svg\/Tinkercad.svg",
                    "name": "Tinkercad",
                    "url": "https:\/\/www.tinkercad.com\/dashboard\/designs\/3d"
                },
                {
                    "img": ".\/svg\/Replit.svg",
                    "name": "Replit",
                    "url": "https:\/\/replit.com\/@Xaival"
                },
                {
                    "img": ".\/svg\/Telegram.svg",
                    "name": "Telegram",
                    "url": "https:\/\/web.telegram.org\/a\/#788502985"
                }
            ]
        },
        {
            "grupo": "Herramientas",
            "marcadores": [
                {
                    "img": ".\/svg\/Texto.svg",
                    "name": "Modificación Texto",
                    "url": "https:\/\/xaival.github.io\/Proyectos-Web\/Herramienta\/Acciones%20sobre%20texto\/Modificaci%C3%B3n%20de%20texto\/"
                },
                {
                    "img": ".\/svg\/Cronometro.svg",
                    "name": "Temporizador",
                    "url": "https:\/\/xaival.github.io\/Proyectos-Web\/Herramienta\/Temporizador\/"
                },
                {
                    "img": ".\/svg\/Calculo.svg",
                    "name": "Regla de 3",
                    "url": "https:\/\/xaival.github.io\/Proyectos-Web\/Herramienta\/Regla%20de%203\/"
                }
            ]
        }
    ]
};
</script>
</body>
</html>
